version: 1.2.9
cache: true

# =============================
# Memory
# =============================
memory:
  disabled: false
  validKeys: ["preferences","work_info","skills","interests","context","learned_facts"]
  tokenLimit: 10000
  personalize: true
  messageWindowSize: 10
  agent:
    provider: "azureOpenAI"
    model: "gpt-5-mini"
    instructions: |
      You are the Hero Memory Manager for Ero Copper.
      Your job is to extract, normalize, and update user memory succinctly and safely. 
      Specifically for learned facts always ask the user if that information is relevant to be remembered.

      STRICT RULES:
      - Allowed keys: preferences, work_info, skills, interests, context, learned_facts
      - Store only stable, long-lived, useful facts. Keep values short and neutral.
      - Never store sensitive personal data, secrets, or third-party identifiers.
      - Prefer updates over duplicates. Remove outdated or contradicted info.
      - For temporary context, set an expiresAt or skip storing.
      OUTPUT: zero or one {key, value} pair to write; if not confident, output none.
    model_parameters:
      temperature: 0.1


# ================================
# Storage
# ================================
# # --- ESTRAT√âGIA DE ARMAZENAMENTO DE ARQUIVOS ---
# # Define o servi√ßo a ser usado para upload e armazenamento de arquivos.
# # O valor deve ser a string exata "azure_blob".
# fileStrategy: "azure_blob"
fileStrategy: "local"


# ================================
# INTERFACE (UI) - Otimizada
# ================================
interface:
  title: 'Hero'
  customWelcome: "{{user.name}}, welcome to Hero! An Ero assisted intelligence model"
  # Temporary chat retention period in hours (2 days = 48 hours)
  temporaryChatRetention: 48
  mcpServers:
    placeholder: "MCP Servers"
  modelSelect: false
  agents: true
  sidePanel: true
  parameters: false
  presets: false
  prompts: true
  bookmarks: false
  multiConvo: false
  webSearch: true
  fileSearch: true
  runCode: true
#  hideEndpoints:
#    - openAI
#    - azureOpenAI
 #   - custom

# ================================
# RATE LIMITS
# ================================
rateLimits:
  fileUploads: { ipMax: 120, ipWindowInMinutes: 60, userMax: 60, userWindowInMinutes: 60 }
  conversationsImport: { ipMax: 30, ipWindowInMinutes: 60, userMax: 20, userWindowInMinutes: 60 }
  stt: { ipMax: 120, ipWindowInMinutes: 10, userMax: 60, userWindowInMinutes: 10, maxSecondsPerRequest: 180 }
  tts: { ipMax: 120, ipWindowInMinutes: 10, userMax: 60, userWindowInMinutes: 10, maxCharsPerRequest: 1200 }
  webSearch: { ipMax: 100, ipWindowInMinutes: 15, userMax: 40, userWindowInMinutes: 15 }
  actions: { ipMax: 200, ipWindowInMinutes: 60, userMax: 100, userWindowInMinutes: 60 }
  codeInterpreter: { ipMax: 60, ipWindowInMinutes: 60, userMax: 30, userWindowInMinutes: 60, maxTimeoutSeconds: 60 }
  imageGeneration: { ipMax: 60, ipWindowInMinutes: 60, userMax: 30, userWindowInMinutes: 60 }

# ================================
# OCR
# ================================
#ocr:
ocr:
  mistralModel: "mistral-document-ai-2505"  # seu deployment no Azure AI
  apiKey: "${AZURE_MISTRAL_OCR_API_KEY}"
  baseURL: "https://friaerohero.services.ai.azure.com/providers/mistral/azure/ocr"
  strategy: "azure_mistral_ocr"



# ========================
# Endpoints (Global Tool Config)
# ========================
endpoints:
  all:
    titleConvo: true
    titleEndpoint: "azureOpenAI"          # garante que usa o endpoint 'agents' (Azure)
    titleModel: "gpt-5-mini"         # use o ID do modelo no grupo, n√£o o nome do deployment
    summarize: true
    summaryEndpoint: "azureOpenAI"
    summaryModel: "gpt-5-mini"
    streamRate: 70                   # (se voc√™ j√° adicionou antes, mantenha)
    titlePrompt: |
      Analyze this conversation and provide:
      A concise title in the detected language (5 words or less, no punctuation or quotation)
      {convo}
  agents:
    disableBuilder: false
    recursionLimit: 50
    maxRecursionLimit: 100
    # üîß Zod imp√µe limites: ‚â§ 50 e ‚â§ 10
    maxCitations: 50            # antes 200 (causava erro)
    maxCitationsPerFile: 10     # antes 200 (causava erro)
    # mant√©m recall alto
    minRelevanceScore: 0.12
    tools:
      order:
        - web_search
        - actions
        - file_search
        - ocr
        - execute_code
        - image_generation
        - artifacts
        - chain
      web_search:
        providerPriority: [serper, tavily, traversaal]
        firecrawl: true # <-- Apenas diz que a ferramenta est√° ATIVA
        reranker:
          enabled: true # <-- Apenas diz que o reranker est√° ATIVO
          providerPriority: [jina] # <-- CORRE√á√ÉO: "jina" deve estar sem aspas e providerPriority √© uma lista
          topN: 8
        maxResults: 16
      file_search:
        enabled: true
        minRelevanceScore: 0.12
        k: 120
        maxCitations: 50
        maxCitationsPerFile: 10
      ocr:
        enabled: true
      execute_code:
        enabled: true
      image_generation:
        providers:
          - openai_images
          - dalle
# ===================================================================
# ARQUIVO DE CONFIGURA√á√ÉO FINAL 
# ===================================================================
    azureOpenAI:
      assistants: true
      embeddings:
        deploymentName: "hero-text-embedding-3-small"   # Sweden Central
        version: "2023-05-15"
      groups:
        # --- Group 1: Sweden Central (PRIMARY) ---
        - group: "sweden-central-models"
          baseURL: "https://hero-openia-sw.openai.azure.com/"
          apiKey: "${AZURE_API_KEY}"                     # from .env (Sweden)
          models:
            gpt-5:
              deploymentName: "hero-gpt-5"
              version: "2025-04-01-preview"
            gpt-5-mini:
              deploymentName: "hero-gpt-5-mini"
              version: "2025-04-01-preview"
            gpt-4o:
              deploymentName: "hero-gpt-4o"
              version: "2025-01-01-preview"
            gpt-4o-mini:
              deploymentName: "hero-gpt-4o-mini"
              version: "2025-01-01-preview"

        # --- Group 2: East US 2 (SECONDARY / FAILOVER) ---
        - group: "eastus2-models"
          baseURL: "https://openiahero2.openai.azure.com/"
          apiKey: "${CUSTOM_AZURE2_API_KEY}"             # from .env (East US 2)
          models:
            gpt-5:
              deploymentName: "gpt-5"
              version: "2025-04-01-preview"
            gpt-5-mini:
              deploymentName: "hero-gpt5-mini"
              version: "2025-04-01-preview"
            gpt-4o:
              deploymentName: "hero-gpt4o"
              version: "2025-01-01-preview"
            gpt-4o-mini:
              deploymentName: "hero-gpt4o-mini"
              version: "2025-01-01-preview"
    custom:
      - name: "AzureVision"
        apiKey: "${AZURE_VISION_EASTUS2_API_KEY}"
        baseURL: "https://hero-aivision.cognitiveservices.azure.com/computervision/imageanalysis:analyze?api-version=2024-02-01&features=read"
        directEndpoint: true
        models:
          default: ["vision-analyze"]
        headers:
          Ocp-Apim-Subscription-Key: "${AZURE_VISION_EASTUS2_API_KEY}"
      - name: "AzureDocIntel"
        apiKey: "${AZURE_DOCINTEL_EASTUS2_API_KEY}"
        baseURL: "https://hero-docintel.cognitiveservices.azure.com/documentintelligence/documentModels/prebuilt-read:analyze?api-version=2024-02-29-preview"
        directEndpoint: true
        models:
          default: ["docintel-read"]
        headers:
          Ocp-Apim-Subscription-Key: "${AZURE_DOCINTEL_EASTUS2_API_KEY}"
      - name: "JinaDeepSearch"
        apiKey: "${JINA_API_KEY}"
        baseURL: "${JINA_BASE_URL}"     # ex.: https://deepsearch.jina.ai/v1
        iconURL: "https://jina.ai/favicon.ico"
        modelDisplayLabel: "DeepSearch"
        models:
          default: ["jina-deepsearch-v1"]
          fetch: false
        titleConvo: false
        addParams:
          stream: true
        headers:
          Authorization: "Bearer ${JINA_API_KEY}"
          Content-Type: "application/json"

# ========================
# Model Catalog (Agent List)
# ========================
modelSpecs:
  enforce: true
  prioritize: true
  list:
    - name: "hero"
      label: "Hero"
      default: true
      description: "The most comum agent for internal activities"
      showIconInMenu: true
      showIconInHeader: true
      preset:
        endpoint: "agents"
        agent_id: "agent_YTU7ohnOfzEon8WEtdggp"

    - name: "hero-deep-research"
      label: "Hero Deep Research"
      description: "The most complex agent for research activities"
      showIconInMenu: true
      showIconInHeader: true
      preset:
        endpoint: "agents"
        agent_id: "agent_0eaIxFnDQSnAcKlUShbhn"

    - name: "hero-prompt-trainer"
      label: "Hero Prompt Trainer"
      description: "Playground Agent for supporint on how to use Generative AI"
      showIconInMenu: true
      showIconInHeader: true
      preset:
        endpoint: "agents"
        agent_id: "agent_giLGsVCYY18fvw_Wh9rLz"

# ================================
# File Upload Configuration
# ================================
fileConfig:
  endpoints:
    default:
      fileLimit: 10
      fileSizeLimit: 20
      totalSizeLimit: 100
      supportedMimeTypes:
        - "application/pdf"
        - "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
        - "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        - "application/vnd.openxmlformats-officedocument.presentationml.presentation"
        - "text/csv"
        - "text/plain"
        - "application/json"
        - "application/x-yaml"
        - "text/yaml"
        - "text/x-python"
        - "application/javascript"
        - "text/x-java-source"
        - "text/html"
        - "text/css"
        - "image/png"
        - "image/jpeg"
        - "image/webp"
        - "image/tiff"
        - "image/.*"
        - "audio/mpeg"
        - "audio/wav"
        - "audio/mp4"
  serverFileSizeLimit: 200
  avatarSizeLimit: 2
  imageGeneration:
    px: 1024

speech:
  speechTab:
    conversationMode: true
    advancedMode: false
    speechToText:
      engineSTT: "external"
      autoTranscribeAudio: true
      decibelValue: -45
      autoSendText: 0
    textToSpeech:
      engineTTS: "external"
      voice: "alloy"
      automaticPlayback: true
      playbackRate: 1.0
      cacheTTS: true
  stt:
    azureOpenAI:
      instanceName: "hero-openia-sw"
      apiKey: "${AZURE_API_KEY}"
      deploymentName: "hero-whisper"
      apiVersion: "2024-06-01"

  tts:
    azureOpenAI:
      instanceName: "hero-openia-sw"
      apiKey: "${AZURE_API_KEY}"
      deploymentName: "hero-tts"
      apiVersion: "2025-03-01-preview"
      model: "tts-1"
      voices: ['alloy', 'echo', 'fable', 'onyx', 'nova', 'shimmer']

